<launch>
  <!-- 机械臂 IP，接口风格与 jaka_openloop_bringup.launch 保持一致 -->
  <arg name="ip" default="192.168.1.100"/>
  <arg name="urdf_file" default="$(find jaka_close_contro)/urdf/jaka_zu3.urdf" />

  <!-- 全局 /ip 参数，兼容以前可能会用到这个参数的节点 -->
  <param name="/ip" value="$(arg ip)"/>

  <!-- 发布官方 URDF 描述，供 robot_state_publisher 生成 TF -->
  <param name="robot_description" textfile="$(arg urdf_file)" />

  <!-- 启动官方 JAKA ROS driver，提供 /jaka_driver/linear_move 等接口 -->
  <node pkg="jaka_driver"
        type="jaka_driver"
        name="jaka_driver"
        output="screen">
    <param name="robot_ip" value="$(arg ip)"/>
  </node>

  <!-- 状态适配：将 /jaka_driver/joint_position 转发为 /joint_states 供 robot_state_publisher 使用 -->
  <node pkg="jaka_close_contro"
        type="jaka_state_adapter_node"
        name="jaka_state_adapter"
        output="screen" />

  <!-- 使用官方 URDF + /joint_states 发布机械臂 TF -->
  <node pkg="robot_state_publisher"
        type="robot_state_publisher"
        name="robot_state_publisher">
    <param name="publish_frequency" value="100.0" />
  </node>
</launch>
